# üöÄ PROCHAINES √âTAPES - Gestionnaire RH Guin√©e

## üìå O√π en sommes-nous ?

**Statut actuel** : 30% compl√©t√©  
**Fondations** : ‚úÖ Solides (BDD, mod√®les, dashboard)  
**√Ä faire** : 70% (vues, forms, templates pour tous les modules)

---

## üéØ PLAN D'ACTION D√âTAILL√â

### üî¥ PHASE 1 : MODULE EMPLOY√âS (2-3 jours) - PRIORIT√â CRITIQUE

#### Jour 1 : Liste et Recherche
**Cr√©er `employes/views.py`** :
```python
from django.views.generic import ListView, DetailView, CreateView, UpdateView, DeleteView
from django.contrib.auth.mixins import LoginRequiredMixin
from .models import Employe
from .forms import EmployeForm

class EmployeListView(LoginRequiredMixin, ListView):
    model = Employe
    template_name = 'employes/list.html'
    context_object_name = 'employes'
    paginate_by = 20
    
    def get_queryset(self):
        queryset = Employe.objects.filter(statut_employe='Actif')
        # Ajouter recherche et filtres
        search = self.request.GET.get('search')
        if search:
            queryset = queryset.filter(
                Q(nom__icontains=search) |
                Q(prenoms__icontains=search) |
                Q(matricule__icontains=search)
            )
        return queryset.select_related('service', 'poste', 'etablissement')
```

**Cr√©er `employes/urls.py`** :
```python
from django.urls import path
from . import views

app_name = 'employes'

urlpatterns = [
    path('', views.EmployeListView.as_view(), name='list'),
    path('create/', views.EmployeCreateView.as_view(), name='create'),
    path('<int:pk>/', views.EmployeDetailView.as_view(), name='detail'),
    path('<int:pk>/edit/', views.EmployeUpdateView.as_view(), name='edit'),
    path('<int:pk>/delete/', views.EmployeDeleteView.as_view(), name='delete'),
]
```

**Cr√©er `templates/employes/list.html`** :
- Barre de recherche
- Filtres (statut, service, type contrat)
- Table DataTables
- Boutons actions (voir, modifier, supprimer)
- Pagination
- Bouton "Nouvel employ√©"

#### Jour 2 : Formulaire Cr√©ation
**Cr√©er `employes/forms.py`** :
```python
from django import forms
from crispy_forms.helper import FormHelper
from crispy_forms.layout import Layout, Fieldset, Row, Column
from .models import Employe

class EmployeForm(forms.ModelForm):
    class Meta:
        model = Employe
        fields = ['civilite', 'nom', 'prenoms', 'sexe', 'date_naissance',
                  'num_cnss_individuel', 'telephone_principal', 'email_professionnel',
                  'etablissement', 'service', 'poste', 'date_embauche', 'type_contrat']
        widgets = {
            'date_naissance': forms.DateInput(attrs={'type': 'date'}),
            'date_embauche': forms.DateInput(attrs={'type': 'date'}),
        }
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.helper = FormHelper()
        self.helper.layout = Layout(
            Fieldset('√âtat civil',
                Row(
                    Column('civilite', css_class='col-md-2'),
                    Column('nom', css_class='col-md-5'),
                    Column('prenoms', css_class='col-md-5'),
                ),
                Row(
                    Column('sexe', css_class='col-md-4'),
                    Column('date_naissance', css_class='col-md-4'),
                    Column('num_cnss_individuel', css_class='col-md-4'),
                ),
            ),
            Fieldset('Contact',
                Row(
                    Column('telephone_principal', css_class='col-md-6'),
                    Column('email_professionnel', css_class='col-md-6'),
                ),
            ),
            Fieldset('Informations professionnelles',
                Row(
                    Column('etablissement', css_class='col-md-4'),
                    Column('service', css_class='col-md-4'),
                    Column('poste', css_class='col-md-4'),
                ),
                Row(
                    Column('date_embauche', css_class='col-md-6'),
                    Column('type_contrat', css_class='col-md-6'),
                ),
            ),
        )
```

**Cr√©er `templates/employes/form.html`** :
- Formulaire avec Crispy Forms
- Validation c√¥t√© client
- Boutons Enregistrer/Annuler

#### Jour 3 : Fiche D√©taill√©e
**Cr√©er `templates/employes/detail.html`** :
- En-t√™te avec photo et infos principales
- Onglets :
  1. Informations g√©n√©rales
  2. Contrats
  3. Salaire
  4. Cong√©s
  5. Formations
  6. Documents
- Boutons actions (modifier, supprimer, imprimer)

---

### üü° PHASE 2 : MODULE TEMPS (2 jours)

#### Jour 4 : Pointages
**Cr√©er `temps_travail/views.py`** :
```python
class PointageListView(LoginRequiredMixin, ListView):
    model = Pointage
    template_name = 'temps_travail/pointages_list.html'
    
class PointageCreateView(LoginRequiredMixin, CreateView):
    model = Pointage
    form_class = PointageForm
    template_name = 'temps_travail/pointage_form.html'
```

**Fonctionnalit√©s** :
- Saisie pointage quotidien
- Calcul automatique heures travaill√©es
- D√©tection heures suppl√©mentaires
- Validation hi√©rarchique

#### Jour 5 : Cong√©s
**Cr√©er vues cong√©s** :
- Liste des demandes
- Formulaire demande
- Validation (2 niveaux)
- Calendrier visuel
- Calcul soldes automatique

---

### üü† PHASE 3 : MODULE PAIE (3-4 jours)

#### Jour 6-7 : Moteur de Calcul
**Cr√©er `paie/calcul.py`** :
```python
class MoteurCalculPaie:
    """Moteur de calcul des bulletins de paie"""
    
    def __init__(self, employe, periode):
        self.employe = employe
        self.periode = periode
        self.bulletin = None
    
    def calculer(self):
        """Calcule le bulletin complet"""
        # 1. Salaire brut
        brut = self.calculer_brut()
        
        # 2. Base CNSS (plafonn√© 3M GNF)
        base_cnss = min(brut, 3000000)
        
        # 3. CNSS employ√© (5%)
        cnss_employe = base_cnss * 0.05
        
        # 4. INAM (2.5%)
        inam = brut * 0.025
        
        # 5. Base IRG
        base_irg = brut - cnss_employe - inam
        
        # 6. Abattement IRG (20%, max 300K)
        abattement = min(base_irg * 0.20, 300000)
        base_irg_nette = base_irg - abattement
        
        # 7. IRG progressif
        irg = self.calculer_irg_progressif(base_irg_nette)
        
        # 8. Net √† payer
        net = brut - cnss_employe - inam - irg
        
        # 9. CNSS employeur (18%)
        cnss_employeur = base_cnss * 0.18
        
        return {
            'brut': brut,
            'cnss_employe': cnss_employe,
            'inam': inam,
            'irg': irg,
            'net': net,
            'cnss_employeur': cnss_employeur,
        }
    
    def calculer_irg_progressif(self, base):
        """Calcul IRG selon bar√®me progressif"""
        tranches = [
            (0, 1000000, 0),
            (1000001, 3000000, 0.05),
            (3000001, 6000000, 0.10),
            (6000001, 12000000, 0.15),
            (12000001, 25000000, 0.20),
            (25000001, None, 0.25),
        ]
        
        irg = 0
        remaining = base
        
        for min_val, max_val, taux in tranches:
            if remaining <= 0:
                break
            
            if max_val:
                taxable = min(remaining, max_val - min_val + 1)
            else:
                taxable = remaining
            
            irg += taxable * taux
            remaining -= taxable
        
        return round(irg)
```

#### Jour 8 : Bulletins et PDF
**Cr√©er `paie/pdf.py`** :
- G√©n√©ration PDF avec ReportLab
- Template bulletin conforme
- Logo soci√©t√©
- Signature

#### Jour 9 : Livre de Paie et D√©clarations
- Vue livre de paie mensuel
- Export Excel
- G√©n√©ration d√©clarations CNSS/IRG/INAM

---

### üü¢ PHASE 4 : TESTS ET D√âBOGAGE (2 jours)

#### Jour 10 : Tests Unitaires
**Cr√©er tests pour chaque module** :
```python
from django.test import TestCase
from employes.models import Employe

class EmployeModelTest(TestCase):
    def setUp(self):
        self.employe = Employe.objects.create(
            matricule='EMP001',
            nom='DIALLO',
            prenoms='Mamadou',
            # ...
        )
    
    def test_employe_creation(self):
        self.assertEqual(self.employe.matricule, 'EMP001')
    
    def test_age_calculation(self):
        # Test calcul √¢ge
        pass
```

#### Jour 11 : Tests d'Int√©gration
- Tests des workflows complets
- Tests de calcul de paie
- Tests de validation cong√©s
- Corrections bugs

---

### üîµ PHASE 5 : D√âPLOIEMENT (1 jour)

#### Jour 12 : Mise en Production
1. Configuration production dans settings.py
2. Collecte des fichiers statiques
3. Migration base de donn√©es
4. Tests de charge
5. Formation utilisateurs
6. Documentation d√©ploiement

---

## üìù CHECKLIST PAR MODULE

### Module Employ√©s
- [ ] views.py (ListView, DetailView, CreateView, UpdateView, DeleteView)
- [ ] urls.py
- [ ] forms.py (EmployeForm, ContratForm)
- [ ] templates/employes/list.html
- [ ] templates/employes/detail.html
- [ ] templates/employes/form.html
- [ ] templates/employes/delete.html
- [ ] Tests unitaires

### Module Temps
- [ ] views.py (Pointages, Cong√©s)
- [ ] urls.py
- [ ] forms.py (PointageForm, CongeForm)
- [ ] templates/temps_travail/pointages_list.html
- [ ] templates/temps_travail/pointage_form.html
- [ ] templates/temps_travail/conges_list.html
- [ ] templates/temps_travail/conge_form.html
- [ ] templates/temps_travail/calendrier.html
- [ ] Tests unitaires

### Module Paie
- [ ] calcul.py (MoteurCalculPaie)
- [ ] views.py (P√©riodes, Bulletins, Livre)
- [ ] urls.py
- [ ] forms.py
- [ ] pdf.py (G√©n√©ration bulletins)
- [ ] templates/paie/periodes_list.html
- [ ] templates/paie/bulletins_list.html
- [ ] templates/paie/bulletin_detail.html
- [ ] templates/paie/livre_paie.html
- [ ] templates/paie/declarations.html
- [ ] Tests unitaires (calculs)

---

## üíª COMMANDES UTILES

```bash
# Cr√©er une nouvelle app Django
python manage.py startapp nom_app

# Cr√©er des migrations
python manage.py makemigrations

# Appliquer les migrations
python manage.py migrate

# Cr√©er un superutilisateur
python manage.py createsuperuser

# Lancer le serveur
python manage.py runserver

# Lancer les tests
python manage.py test

# Shell Django
python manage.py shell

# Collecter les fichiers statiques
python manage.py collectstatic

# Cr√©er des fixtures
python manage.py dumpdata app.Model > fixtures/data.json

# Charger des fixtures
python manage.py loaddata fixtures/data.json
```

---

## üìö RESSOURCES UTILES

### Documentation Django
- https://docs.djangoproject.com/
- https://ccbv.co.uk/ (Class-Based Views)
- https://django-crispy-forms.readthedocs.io/

### Biblioth√®ques
- Bootstrap 5: https://getbootstrap.com/
- Chart.js: https://www.chartjs.org/
- DataTables: https://datatables.net/
- ReportLab: https://www.reportlab.com/

### Code du Travail Guin√©e
- Loi L/2014/072/CNT
- CNSS: http://www.cnss-guinee.org/
- DGI: https://dgi.gov.gn/

---

## üéØ OBJECTIFS FINAUX

1. ‚úÖ Application compl√®te et fonctionnelle
2. ‚úÖ Interface moderne et responsive
3. ‚úÖ Calculs de paie conformes
4. ‚úÖ Workflows de validation
5. ‚úÖ Rapports et statistiques
6. ‚úÖ Exports Excel/PDF
7. ‚úÖ Tests automatis√©s (>70% coverage)
8. ‚úÖ Documentation compl√®te
9. ‚úÖ D√©ploiement production
10. ‚úÖ Formation utilisateurs

---

## üìû SUPPORT

Pour toute question :
- üìß Email : dev@votre-entreprise.com
- üì± T√©l√©phone : +224 XXX XXX XXX
- üìñ Documentation : docs/

---

**üöÄ Pr√™t √† continuer le d√©veloppement !**

**Prochaine √©tape** : Commencer par le module Employ√©s (Jour 1)
